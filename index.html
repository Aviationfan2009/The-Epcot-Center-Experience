<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Updating GPS</title>
    <style>
        body { font-family: sans-serif; padding: 20px; text-align: center; }
        #status-box { 
            background: #f4f4f9; 
            border-radius: 8px; 
            padding: 20px; 
            margin: 20px auto; 
            max-width: 400px;
            border: 1px solid #ddd;
        }
        .coords { font-size: 1.2rem; font-family: monospace; color: #007bff; }
        .timestamp { font-size: 0.8rem; color: #666; margin-top: 10px; }
        button { padding: 10px 20px; font-size: 1rem; cursor: pointer; margin: 5px; }
        #stop-btn { background-color: #ff4d4d; color: white; border: none; display: none; }
        #start-btn { background-color: #4CAF50; color: white; border: none; }
    </style>
</head>
<body>

    <h2>Auto-Updating Tracker</h2>
    <p>Movement will update the coordinates automatically.</p>

    <div id="status-box">
        <div id="display">Click start to track movement</div>
        <div id="time" class="timestamp"></div>
    </div>

    <button id="start-btn" onclick="startTracking()">Start Tracking</button>
    <button id="stop-btn" onclick="stopTracking()">Stop Tracking</button>

    <script>
        let watchID = null; // Variable to store the listener ID

        function startTracking() {
            if (!navigator.geolocation) {
                alert("Geolocation not supported");
                return;
            }

            // UI Changes
            document.getElementById("start-btn").style.display = "none";
            document.getElementById("stop-btn").style.display = "inline-block";
            document.getElementById("display").innerHTML = "Waiting for GPS signal...";

            // watchPosition runs EVERY time the device moves
            watchID = navigator.geolocation.watchPosition(
                (position) => {
                    const lat = position.coords.latitude.toFixed(6);
                    const lon = position.coords.longitude.toFixed(6);
                    const time = new Date(position.timestamp).toLocaleTimeString();

                    document.getElementById("display").innerHTML = `
                        <div class="coords">Lat: ${lat}</div>
                        <div class="coords">Lon: ${lon}</div>
                    `;
                    document.getElementById("time").innerHTML = `Last updated: ${time}`;
                },
                (error) => {
                    document.getElementById("display").innerHTML = `Error: ${error.message}`;
                    stopTracking(); // Stop if there's a permanent error
                },
                {
                    enableHighAccuracy: true, // Force GPS usage for better movement detection
                    timeout: 10000,
                    maximumAge: 0             // Don't use old cached data
                }
            );
        }

        function stopTracking() {
            if (watchID !== null) {
                navigator.geolocation.clearWatch(watchID); // This stops the hardware GPS
                watchID = null;
            }
            
            document.getElementById("start-btn").style.display = "inline-block";
            document.getElementById("stop-btn").style.display = "none";
            document.getElementById("display").innerHTML = "Tracking Stopped.";
            document.getElementById("time").innerHTML = "";
        }
    </script>
</body>
</html>
